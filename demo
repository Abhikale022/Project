package com.scb.creditcardorigination.TransactionProcessingSystem.controller;

import com.scb.creditcardorigination.TransactionProcessingSystem.model.Transaction;
import com.scb.creditcardorigination.TransactionProcessingSystem.service.TransactionService;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.Map;
@CrossOrigin(origins = "http://localhost:3000")
@RestController
@RequestMapping("/api/transactions")
public class TransactionController {
    private final TransactionService transactionService;

    public TransactionController(TransactionService transactionService) {
        this.transactionService = transactionService;
    }

    @PostMapping("/create")
    public Transaction createTransaction(@RequestBody Transaction transaction) {
        return transactionService.saveTransaction(transaction);
    }
    //    {
//        "customerId": 1005,
//            "name": "saba",
//            "dob": "2003-04-29",
//            "email": "saba@example.com",
//            "phone": "+91-9876112233",
//            "creditScore": 720,
//            "product": "Gold Rewards Card",
//            "validityPeriod": "2025-2030",
//            "creditLimit": "â‚¹1,80,000",
//            "status": "Approved" ,
//            "processed_by" :"System -auto- decision",
//            "Application-Timeline" :"Printed"
//
//    }
    @GetMapping("/all")
    public List<Transaction> getAllTransactions() {
        return transactionService.getAllTransactions();
    }

    @PutMapping("/{id}/timeline")
    public Transaction updateTimeline(@PathVariable Long id, @RequestBody Map<String, String> request) {
        String newTimeline = request.get("applicationTimeline");
        return transactionService.updateTimeline(id, newTimeline);
    }
}
