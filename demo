if (mode === "signup") {
  if (!formData.name || !formData.email || !formData.password || !formData.confirmPassword) {
    setError("All fields are required.");
    return;
  }
  if (formData.password !== formData.confirmPassword) {
    setError("Passwords do not match.");
    return;
  }

  try {
    const response = await UnifiedLoginModalService.signupCustomer({
      name: formData.name,
      email: formData.email,
      password: formData.password,
    });
    console.log("signup response:", response);

    setSuccess("Account created successfully! Please login.");
    setMode("customer");
    resetForm();
  } catch (err) {
    setError(err.error || "Signup failed.");
  }
  return;
}

if (mode === "customer") {
  if (!formData.username || !formData.password) {
    setError("Both email and password are required.");
    return;
  }

  try {
    const response = await UnifiedLoginModalService.loginCustomer({
      username: formData.username,
      password: formData.password,
    });
    console.log("customer login response:", response);

    setSuccess("Customer login successful!");
    localStorage.setItem("token", response.token); // save JWT
    setTimeout(() => {
      onHide();
      navigate("/CreditCardApplicationForm");
    }, 1500);
  } catch (err) {
    setError(err.error || "Invalid email or password.");
  }
  return;
}